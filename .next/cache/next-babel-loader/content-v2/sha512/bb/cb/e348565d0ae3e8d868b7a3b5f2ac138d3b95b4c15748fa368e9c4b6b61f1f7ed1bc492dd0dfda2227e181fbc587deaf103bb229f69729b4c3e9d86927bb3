{"ast":null,"code":"import _regeneratorRuntime from \"C:/Users/Rico/Desktop/Home/Kalbe app/sakamor-new/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"C:/Users/Rico/Desktop/Home/Kalbe app/sakamor-new/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport \"firebase/messaging\";\nimport firebase from \"firebase/app\";\nvar firebaseCloudMessaging = {\n  //checking whether token is available in indexed DB\n  tokenInlocalforage: function () {\n    var _tokenInlocalforage = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              return _context.abrupt(\"return\", localStorage.getItem(\"fcm_token\"));\n\n            case 1:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee);\n    }));\n\n    function tokenInlocalforage() {\n      return _tokenInlocalforage.apply(this, arguments);\n    }\n\n    return tokenInlocalforage;\n  }(),\n  //initializing firebase app\n  init: function () {\n    var _init = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2() {\n      var messaging, tokenInLocalForage, status, fcm_token;\n      return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              if (firebase.apps.length) {\n                _context2.next = 25;\n                break;\n              }\n\n              firebase.initializeApp({\n                apiKey: \"AIzaSyAMTirYpyzY7QWDkzSPsofpo68jaFltnrk\",\n                authDomain: \"sakamor-8f28d.firebaseapp.com\",\n                projectId: \"sakamor-8f28d\",\n                storageBucket: \"sakamor-8f28d.appspot.com\",\n                messagingSenderId: \"400720458166\",\n                appId: \"1:400720458166:web:cf7afc06ec3ac419d69117\"\n              });\n              _context2.prev = 2;\n              messaging = firebase.messaging();\n              _context2.next = 6;\n              return this.tokenInlocalforage();\n\n            case 6:\n              tokenInLocalForage = _context2.sent;\n\n              if (!(tokenInLocalForage !== null)) {\n                _context2.next = 9;\n                break;\n              }\n\n              return _context2.abrupt(\"return\", tokenInLocalForage);\n\n            case 9:\n              _context2.next = 11;\n              return Notification.requestPermission();\n\n            case 11:\n              status = _context2.sent;\n\n              if (!(status && status === \"granted\")) {\n                _context2.next = 19;\n                break;\n              }\n\n              _context2.next = 15;\n              return messaging.getToken();\n\n            case 15:\n              fcm_token = _context2.sent;\n\n              if (!fcm_token) {\n                _context2.next = 19;\n                break;\n              }\n\n              //setting FCM token in indexed db using localforage\n              localStorage.setItem(\"fcm_token\", fcm_token); //return the FCM token after saving it\n\n              return _context2.abrupt(\"return\", fcm_token);\n\n            case 19:\n              _context2.next = 25;\n              break;\n\n            case 21:\n              _context2.prev = 21;\n              _context2.t0 = _context2[\"catch\"](2);\n              console.error(_context2.t0);\n              return _context2.abrupt(\"return\", null);\n\n            case 25:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, _callee2, this, [[2, 21]]);\n    }));\n\n    function init() {\n      return _init.apply(this, arguments);\n    }\n\n    return init;\n  }()\n};\nexport { firebaseCloudMessaging };","map":{"version":3,"sources":["C:/Users/Rico/Desktop/Home/Kalbe app/sakamor-new/webPush.js"],"names":["firebase","firebaseCloudMessaging","tokenInlocalforage","localStorage","getItem","init","apps","length","initializeApp","apiKey","authDomain","projectId","storageBucket","messagingSenderId","appId","messaging","tokenInLocalForage","Notification","requestPermission","status","getToken","fcm_token","setItem","console","error"],"mappings":";;AAAA,OAAO,oBAAP;AACA,OAAOA,QAAP,MAAqB,cAArB;AAEA,IAAMC,sBAAsB,GAAG;AAC7B;AACAC,EAAAA,kBAAkB;AAAA,uFAAE;AAAA;AAAA;AAAA;AAAA;AAAA,+CACXC,YAAY,CAACC,OAAb,CAAqB,WAArB,CADW;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAAF;;AAAA;AAAA;AAAA;;AAAA;AAAA,KAFW;AAM7B;AACAC,EAAAA,IAAI;AAAA,yEAAE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBACCL,QAAQ,CAACM,IAAT,CAAcC,MADf;AAAA;AAAA;AAAA;;AAEFP,cAAAA,QAAQ,CAACQ,aAAT,CAAuB;AACrBC,gBAAAA,MAAM,EAAE,yCADa;AAErBC,gBAAAA,UAAU,EAAE,+BAFS;AAGrBC,gBAAAA,SAAS,EAAE,eAHU;AAIrBC,gBAAAA,aAAa,EAAE,2BAJM;AAKrBC,gBAAAA,iBAAiB,EAAE,cALE;AAMrBC,gBAAAA,KAAK,EAAE;AANc,eAAvB;AAFE;AAYMC,cAAAA,SAZN,GAYkBf,QAAQ,CAACe,SAAT,EAZlB;AAAA;AAAA,qBAaiC,KAAKb,kBAAL,EAbjC;;AAAA;AAaMc,cAAAA,kBAbN;;AAAA,oBAgBIA,kBAAkB,KAAK,IAhB3B;AAAA;AAAA;AAAA;;AAAA,gDAiBSA,kBAjBT;;AAAA;AAAA;AAAA,qBAqBqBC,YAAY,CAACC,iBAAb,EArBrB;;AAAA;AAqBMC,cAAAA,MArBN;;AAAA,oBAsBIA,MAAM,IAAIA,MAAM,KAAK,SAtBzB;AAAA;AAAA;AAAA;;AAAA;AAAA,qBAwB0BJ,SAAS,CAACK,QAAV,EAxB1B;;AAAA;AAwBQC,cAAAA,SAxBR;;AAAA,mBAyBMA,SAzBN;AAAA;AAAA;AAAA;;AA0BI;AACAlB,cAAAA,YAAY,CAACmB,OAAb,CAAqB,WAArB,EAAkCD,SAAlC,EA3BJ,CA4BI;;AA5BJ,gDA6BWA,SA7BX;;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAiCAE,cAAAA,OAAO,CAACC,KAAR;AAjCA,gDAkCO,IAlCP;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAAF;;AAAA;AAAA;AAAA;;AAAA;AAAA;AAPyB,CAA/B;AA8CA,SAASvB,sBAAT","sourcesContent":["import \"firebase/messaging\";\r\nimport firebase from \"firebase/app\";\r\n\r\nconst firebaseCloudMessaging = {\r\n  //checking whether token is available in indexed DB\r\n  tokenInlocalforage: async () => {\r\n    return localStorage.getItem(\"fcm_token\");\r\n  },\r\n\r\n  //initializing firebase app\r\n  init: async function () {\r\n    if (!firebase.apps.length) {\r\n      firebase.initializeApp({\r\n        apiKey: \"AIzaSyAMTirYpyzY7QWDkzSPsofpo68jaFltnrk\",\r\n        authDomain: \"sakamor-8f28d.firebaseapp.com\",\r\n        projectId: \"sakamor-8f28d\",\r\n        storageBucket: \"sakamor-8f28d.appspot.com\",\r\n        messagingSenderId: \"400720458166\",\r\n        appId: \"1:400720458166:web:cf7afc06ec3ac419d69117\",\r\n      });\r\n\r\n      try {\r\n        const messaging = firebase.messaging();\r\n        const tokenInLocalForage = await this.tokenInlocalforage();\r\n\r\n        //if FCM token is already there just return the token\r\n        if (tokenInLocalForage !== null) {\r\n          return tokenInLocalForage;\r\n        }\r\n\r\n        //requesting notification permission from browser\r\n        const status = await Notification.requestPermission();\r\n        if (status && status === \"granted\") {\r\n          //getting token from FCM\r\n          const fcm_token = await messaging.getToken();\r\n          if (fcm_token) {\r\n            //setting FCM token in indexed db using localforage\r\n            localStorage.setItem(\"fcm_token\", fcm_token);\r\n            //return the FCM token after saving it\r\n            return fcm_token;\r\n          }\r\n        }\r\n      } catch (error) {\r\n        console.error(error);\r\n        return null;\r\n      }\r\n    }\r\n  },\r\n};\r\nexport { firebaseCloudMessaging };\r\n"]},"metadata":{},"sourceType":"module"}