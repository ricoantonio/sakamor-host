{"ast":null,"code":"import \"firebase/messaging\";\nimport firebase from \"firebase/app\";\nconst firebaseCloudMessaging = {\n  //checking whether token is available in indexed DB\n  tokenInlocalforage: async () => {\n    return localStorage.getItem(\"fcm_token\");\n  },\n  userInlocalforage: async () => {\n    return localStorage.getItem(\"user\");\n  },\n  //initializing firebase app\n  init: async function () {\n    if (!firebase.apps.length) {\n      firebase.initializeApp({\n        apiKey: \"AIzaSyAMTirYpyzY7QWDkzSPsofpo68jaFltnrk\",\n        authDomain: \"sakamor-8f28d.firebaseapp.com\",\n        projectId: \"sakamor-8f28d\",\n        storageBucket: \"sakamor-8f28d.appspot.com\",\n        messagingSenderId: \"400720458166\",\n        appId: \"1:400720458166:web:cf7afc06ec3ac419d69117\"\n      });\n\n      try {\n        const messaging = firebase.messaging();\n        const tokenInLocalForage = await this.tokenInlocalforage();\n        const userInlocalforage = await this.userInlocalforage(); //if FCM token is already there just return the token\n\n        if (tokenInLocalForage !== null) {\n          return tokenInLocalForage;\n        }\n\n        if (userInlocalforage) {\n          //requesting notification permission from browser\n          const status = await Notification.requestPermission();\n\n          if (status && status === \"granted\") {\n            //getting token from FCM\n            const fcm_token = await messaging.getToken();\n\n            if (fcm_token) {\n              //setting FCM token in indexed db using localforage\n              localStorage.setItem(\"fcm_token\", fcm_token); //return the FCM token after saving it\n\n              return fcm_token;\n            }\n          }\n        }\n      } catch (error) {\n        console.error(error);\n        return null;\n      }\n    }\n  }\n};\nexport { firebaseCloudMessaging };","map":null,"metadata":{},"sourceType":"module"}