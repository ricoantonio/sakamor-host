{"ast":null,"code":"import { jsxs as _jsxs } from \"react/jsx-runtime\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport React, { useState, useEffect, useContext } from \"react\";\nimport Link from \"next/link\";\nimport Router from \"next/router\";\nimport { Stores } from \"../../../store\";\nimport styles from \"../../../styles/pages/Spreading.module.css\";\nimport Nav from \"../../../components/Nav\";\nimport Spinner from \"../../../components/Spinner\";\nimport Button from \"../../../components/Button\";\nimport Card from \"../../../components/Card\";\nimport { getSearchJenisChannel, getSearchOutlet } from \"../../../helper\";\nexport default function Spreading() {\n  const {\n    state,\n    dispatch,\n    actions\n  } = useContext(Stores);\n  const {\n    0: plan,\n    1: setPlan\n  } = useState([]);\n  const {\n    0: searchJenisChannel,\n    1: setSearchJenisChannel\n  } = useState(\"\");\n  const {\n    0: listJenisChannel,\n    1: setListJenisChannel\n  } = useState([]);\n  const {\n    0: renderListJenisChannel,\n    1: setRenderListJenisChannel\n  } = useState(false);\n  const {\n    0: focusJenisChannel,\n    1: setFocusJenisChannel\n  } = useState({});\n  const {\n    0: searchOutlet,\n    1: setSearchOutlet\n  } = useState(\"\");\n  const {\n    0: listOutlet,\n    1: setListOutlet\n  } = useState([]);\n  const {\n    0: renderListOutlet,\n    1: setRenderListOutlet\n  } = useState(false);\n  const {\n    0: focusOutlet,\n    1: setFocusOutlet\n  } = useState({});\n  const {\n    0: position,\n    1: setPosition\n  } = useState({});\n  const {\n    0: loading,\n    1: setLoading\n  } = useState(false);\n  const {\n    0: error,\n    1: setError\n  } = useState(null);\n  useEffect(() => {\n    // fetch on stop typing\n    const timeoutId = setTimeout(() => {\n      if (focusJenisChannel.jenisChannelID) {\n        getSearchOutlet(focusJenisChannel.jenisChannelID, searchOutlet).then(data => {\n          setListOutlet(data);\n        }).catch(err => {\n          console.log(err);\n        });\n      } else {\n        setListOutlet([]);\n      }\n    }, 1000);\n    return () => clearTimeout(timeoutId);\n  }, [searchOutlet]);\n\n  const renderSearchJenisChannel = () => {\n    const render = listJenisChannel.map((val, index) => {\n      return /*#__PURE__*/_jsx(\"div\", {\n        onClick: () => {\n          setFocusJenisChannel(val);\n          setSearchJenisChannel(val.namaJenisChannel);\n          setListJenisChannel([]);\n          setSearchOutlet(\"\");\n          setFocusOutlet({});\n        },\n        style: {\n          borderBottom: \".5px solid #f0f0f0\",\n          width: \"350px\"\n        },\n        children: val.namaJenisChannel\n      }, index);\n    });\n    return render;\n  };\n\n  const renderSearchOutlet = () => {\n    const render = listOutlet.map((val, index) => {\n      return /*#__PURE__*/_jsx(\"div\", {\n        onClick: () => {\n          setFocusOutlet(val);\n          setSearchOutlet(val.namaOutlet);\n          setListOutlet([]);\n        },\n        style: {\n          borderBottom: \".5px solid #f0f0f0\",\n          width: \"350px\"\n        },\n        children: val.namaOutlet\n      }, index);\n    });\n    return render;\n  };\n\n  const onSearchJenisChannel = search => {\n    setRenderListJenisChannel(true);\n    setSearchJenisChannel(search);\n\n    if (search) {\n      getSearchJenisChannel(search).then(data => {\n        setListJenisChannel(data);\n      }).catch(err => {\n        console.log(err);\n      });\n    } else {\n      setListJenisChannel([]);\n    }\n  };\n\n  const onSearchOutlet = search => {\n    setRenderListOutlet(true);\n    setSearchOutlet(search);\n  };\n\n  const onSubmitSpreading = () => {\n    if (focusJenisChannel.namaJenisChannel && focusOutlet.namaOutlet) {\n      actions.setSpreadingOutlet(focusOutlet);\n      actions.setSpreadingJenisChannel(focusJenisChannel);\n      Router.push(\"/visit/spreading/submit\");\n    }\n  };\n\n  const render = () => {\n    if (loading) {\n      return /*#__PURE__*/_jsx(Spinner, {});\n    } else {\n      return /*#__PURE__*/_jsx(\"div\", {\n        className: styles.container,\n        children: /*#__PURE__*/_jsxs(\"div\", {\n          className: styles.wrapper,\n          children: [/*#__PURE__*/_jsx(Nav, {\n            backHref: \"/\"\n          }), /*#__PURE__*/_jsx(\"div\", {\n            className: styles.title_container,\n            children: /*#__PURE__*/_jsx(\"div\", {\n              className: styles.title,\n              children: \"Spreading\"\n            })\n          }), /*#__PURE__*/_jsxs(\"div\", {\n            className: styles.main,\n            children: [/*#__PURE__*/_jsx(\"div\", {\n              className: styles.subtitle,\n              children: \"Jenis Channel\"\n            }), /*#__PURE__*/_jsx(\"input\", {\n              onChange: e => {\n                onSearchJenisChannel(e.target.value);\n                setFocusJenisChannel({});\n                setSearchOutlet(\"\");\n                setFocusOutlet({});\n              },\n              value: searchJenisChannel,\n              placeholder: \"Search\",\n              className: styles.input,\n              onBlur: () => {\n                setTimeout(() => {\n                  setRenderListJenisChannel(false);\n                }, 200);\n              },\n              onFocus: e => onSearchJenisChannel(e.target.value)\n            }), renderListJenisChannel ? /*#__PURE__*/_jsx(\"div\", {\n              style: {\n                position: \"absolute\",\n                maxHeight: \"180px\",\n                backgroundColor: \"white\",\n                overflowY: \"scroll\",\n                maxWidth: \"400px\",\n                padding: \"0 4px\",\n                zIndex: 999999\n              },\n              children: renderSearchJenisChannel()\n            }) : null, /*#__PURE__*/_jsx(\"div\", {\n              className: styles.subtitle,\n              children: \"Outlet\"\n            }), /*#__PURE__*/_jsx(\"input\", {\n              disabled: focusJenisChannel.namaJenisChannel ? false : true,\n              onChange: e => {\n                onSearchOutlet(e.target.value);\n              },\n              value: searchOutlet,\n              placeholder: \"Search\",\n              className: styles.input,\n              onBlur: () => {\n                setTimeout(() => {\n                  setRenderListOutlet(false);\n                }, 200);\n              },\n              onFocus: e => onSearchOutlet(e.target.value)\n            }), renderListOutlet ? /*#__PURE__*/_jsx(\"div\", {\n              style: {\n                position: \"absolute\",\n                maxHeight: \"180px\",\n                backgroundColor: \"white\",\n                overflowY: \"scroll\",\n                maxWidth: \"400px\",\n                padding: \"0 4px\",\n                zIndex: 999999\n              },\n              children: renderSearchOutlet()\n            }) : null, /*#__PURE__*/_jsxs(\"div\", {\n              className: styles.bottom_container,\n              children: [/*#__PURE__*/_jsx(Button, {\n                text: \"Submit\",\n                onClick: () => {\n                  onSubmitSpreading();\n                }\n              }), /*#__PURE__*/_jsx(Link, {\n                href: \"/visit/spreading/history\",\n                children: /*#__PURE__*/_jsx(\"a\", {\n                  children: /*#__PURE__*/_jsx(\"div\", {\n                    className: styles.view_history,\n                    children: \"View History\"\n                  })\n                })\n              }), /*#__PURE__*/_jsx(Link, {\n                href: \"/visit/spreading/submit?new=true\",\n                children: /*#__PURE__*/_jsx(\"a\", {\n                  style: {\n                    textDecoration: \"none\"\n                  },\n                  children: /*#__PURE__*/_jsx(Card, {\n                    style: {\n                      borderRadius: \"5px\",\n                      margin: \"22px 0\"\n                    },\n                    children: /*#__PURE__*/_jsxs(\"div\", {\n                      className: styles.unplan_grid2,\n                      children: [/*#__PURE__*/_jsx(\"div\", {\n                        className: styles.add_unplan,\n                        children: /*#__PURE__*/_jsx(\"div\", {\n                          style: {\n                            marginTop: \"-8px\"\n                          },\n                          children: \"+\"\n                        })\n                      }), /*#__PURE__*/_jsxs(\"div\", {\n                        style: {\n                          fontSize: \"16px\",\n                          fontWeight: \"600\"\n                        },\n                        children: [\"Add new outlet\", /*#__PURE__*/_jsx(\"div\", {\n                          style: {\n                            color: \"#B9B9C3\",\n                            fontWeight: \"300\",\n                            fontSize: \"13px\"\n                          },\n                          children: \"Outlet not available\"\n                        }), \" \"]\n                      }), /*#__PURE__*/_jsx(\"div\", {\n                        style: {\n                          textAlign: \"center\"\n                        },\n                        children: /*#__PURE__*/_jsx(\"img\", {\n                          src: \"/next.svg\"\n                        })\n                      })]\n                    })\n                  })\n                })\n              })]\n            })]\n          })]\n        })\n      });\n    }\n  };\n\n  return render();\n}","map":null,"metadata":{},"sourceType":"module"}