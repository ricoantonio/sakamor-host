{"ast":null,"code":"import _regeneratorRuntime from \"C:/Users/Rico/Desktop/Home/Kalbe app/sakamor-new/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"C:/Users/Rico/Desktop/Home/Kalbe app/sakamor-new/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport \"firebase/messaging\";\nimport firebase from \"firebase/app\";\nvar firebaseCloudMessaging = {\n  //checking whether token is available in indexed DB\n  tokenInlocalforage: function () {\n    var _tokenInlocalforage = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              return _context.abrupt(\"return\", localStorage.getItem(\"fcm_token\"));\n\n            case 1:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee);\n    }));\n\n    function tokenInlocalforage() {\n      return _tokenInlocalforage.apply(this, arguments);\n    }\n\n    return tokenInlocalforage;\n  }(),\n  userInlocalforage: function () {\n    var _userInlocalforage = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2() {\n      return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              return _context2.abrupt(\"return\", localStorage.getItem(\"user\"));\n\n            case 1:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, _callee2);\n    }));\n\n    function userInlocalforage() {\n      return _userInlocalforage.apply(this, arguments);\n    }\n\n    return userInlocalforage;\n  }(),\n  //initializing firebase app\n  init: function () {\n    var _init = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee3() {\n      var messaging, tokenInLocalForage, userInlocalforage, status, fcm_token;\n      return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n        while (1) {\n          switch (_context3.prev = _context3.next) {\n            case 0:\n              if (firebase.apps.length) {\n                _context3.next = 29;\n                break;\n              }\n\n              firebase.initializeApp({\n                apiKey: \"AIzaSyAMTirYpyzY7QWDkzSPsofpo68jaFltnrk\",\n                authDomain: \"sakamor-8f28d.firebaseapp.com\",\n                projectId: \"sakamor-8f28d\",\n                storageBucket: \"sakamor-8f28d.appspot.com\",\n                messagingSenderId: \"400720458166\",\n                appId: \"1:400720458166:web:cf7afc06ec3ac419d69117\"\n              });\n              _context3.prev = 2;\n              messaging = firebase.messaging();\n              _context3.next = 6;\n              return this.tokenInlocalforage();\n\n            case 6:\n              tokenInLocalForage = _context3.sent;\n              _context3.next = 9;\n              return this.userInlocalforage();\n\n            case 9:\n              userInlocalforage = _context3.sent;\n\n              if (!(tokenInLocalForage !== null)) {\n                _context3.next = 12;\n                break;\n              }\n\n              return _context3.abrupt(\"return\", tokenInLocalForage);\n\n            case 12:\n              if (!userInlocalforage) {\n                _context3.next = 23;\n                break;\n              }\n\n              _context3.next = 15;\n              return Notification.requestPermission();\n\n            case 15:\n              status = _context3.sent;\n\n              if (!(status && status === \"granted\")) {\n                _context3.next = 23;\n                break;\n              }\n\n              _context3.next = 19;\n              return messaging.getToken();\n\n            case 19:\n              fcm_token = _context3.sent;\n\n              if (!fcm_token) {\n                _context3.next = 23;\n                break;\n              }\n\n              //setting FCM token in indexed db using localforage\n              localStorage.setItem(\"fcm_token\", fcm_token); //return the FCM token after saving it\n\n              return _context3.abrupt(\"return\", fcm_token);\n\n            case 23:\n              _context3.next = 29;\n              break;\n\n            case 25:\n              _context3.prev = 25;\n              _context3.t0 = _context3[\"catch\"](2);\n              console.error(_context3.t0);\n              return _context3.abrupt(\"return\", null);\n\n            case 29:\n            case \"end\":\n              return _context3.stop();\n          }\n        }\n      }, _callee3, this, [[2, 25]]);\n    }));\n\n    function init() {\n      return _init.apply(this, arguments);\n    }\n\n    return init;\n  }()\n};\nexport { firebaseCloudMessaging };","map":null,"metadata":{},"sourceType":"module"}