{"ast":null,"code":"import { jsxs as _jsxs } from \"react/jsx-runtime\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport React, { useState, useEffect, useContext } from \"react\";\nimport Router from \"next/router\";\nimport { Stores } from \"../../../../store\";\nimport styles from \"../../../../styles/components/History.module.css\";\nimport Nav from \"../../../../components/Nav\";\nimport Spinner from \"../../../../components/Spinner\";\nimport Button from \"../../../../components/Button\";\nimport DetailPlan from \"../../../../components/DetailPlan\";\nimport Link from \"next/link\";\nimport Card from \"../../../../components/Card\";\nimport { getAuth, getUnplanNearMe } from \"../../../../helper\";\nimport setUnplanOutlet from \"../../../../store/actions/setUnplanOutlet\";\nexport default function History(_ref) {\n  var type = _ref.type;\n\n  var _useContext = useContext(Stores),\n      state = _useContext.state,\n      dispatch = _useContext.dispatch,\n      actions = _useContext.actions;\n\n  var _useState = useState([]),\n      nearMe = _useState[0],\n      setNearMe = _useState[1];\n\n  var _useState2 = useState(\"\"),\n      search = _useState2[0],\n      setSearch = _useState2[1];\n\n  var _useState3 = useState(true),\n      loading = _useState3[0],\n      setLoading = _useState3[1];\n\n  var _useState4 = useState({}),\n      position = _useState4[0],\n      setPosition = _useState4[1];\n\n  var _useState5 = useState(\"\"),\n      error = _useState5[0],\n      setError = _useState5[1];\n\n  useEffect(function () {\n    var geo = navigator.geolocation;\n\n    if (!geo) {\n      setError(\"Geolocation is not supported\");\n      return;\n    }\n\n    var watcher = geo.watchPosition(function (_ref2) {\n      var coords = _ref2.coords;\n      setPosition({\n        latitude: coords.latitude,\n        longitude: coords.longitude\n      }); // console.log(coords);\n    }, function (err) {\n      setError(err.message);\n    });\n    return function () {\n      return geo.clearWatch(watcher);\n    };\n  }, []);\n  useEffect(function () {\n    var userData = JSON.parse(localStorage.getItem(\"user\"));\n    var userMenu = JSON.parse(localStorage.getItem(\"menu\"));\n\n    if (userData) {\n      getAuth(userData).then(function (data) {\n        var auth = data.filter(function (val) {\n          return val.moduleCode === type;\n        });\n        var menu = userMenu.filter(function (val) {\n          return val.moduleCode === type;\n        });\n\n        if (!(auth && menu)) {\n          Router.push(\"/\");\n        }\n      })[\"catch\"](function (err) {\n        console.log(err);\n      });\n    } else {\n      Router.push(\"/\");\n    }\n  }, [dispatch]);\n  useEffect(function () {\n    getUnplanNearMe().then(function (res) {\n      setNearMe(res);\n      console.log(res);\n      setLoading(false);\n    })[\"catch\"](function (err) {\n      console.log(err);\n    });\n  }, [dispatch]);\n\n  var renderList = function renderList() {\n    var filterData = nearMe.filter(function (val) {\n      if (val.namaOutlet !== null) {\n        return val.namaOutlet.toLowerCase().includes(search.toLowerCase()) || val.alamatOutlet.toLowerCase().includes(search.toLowerCase());\n      }\n    });\n    var render = filterData.map(function (val, index) {\n      return /*#__PURE__*/_jsx(Card, {\n        style: {\n          marginTop: \"22px\",\n          borderRadius: \"5px\"\n        },\n        children: /*#__PURE__*/_jsx(\"div\", {\n          style: {\n            padding: \"21px 18px\"\n          },\n          children: /*#__PURE__*/_jsx(\"div\", {\n            className: styles.top_grid,\n            children: /*#__PURE__*/_jsxs(\"div\", {\n              children: [/*#__PURE__*/_jsx(\"div\", {\n                style: {\n                  fontSize: \"18px\",\n                  fontWeight: \"500\"\n                },\n                children: val.namaOutlet\n              }), /*#__PURE__*/_jsx(\"div\", {\n                style: {\n                  fontSize: \"12px\",\n                  fontWeight: \"400\"\n                },\n                children: val.alamatOutlet\n              }), /*#__PURE__*/_jsx(Link, {\n                href: \"/visit/unplan/nearme/\".concat(val.outletID),\n                children: /*#__PURE__*/_jsx(\"a\", {\n                  children: /*#__PURE__*/_jsx(\"div\", {\n                    style: {\n                      textAlign: \"center\",\n                      margin: \"10px 0\",\n                      paddingTop: \"14px\"\n                    },\n                    children: /*#__PURE__*/_jsx(Button, {\n                      color: \"white\",\n                      text: \"More\",\n                      onClick: function onClick() {\n                        actions.setUnplanOutlet(val);\n                      }\n                    })\n                  })\n                })\n              })]\n            })\n          })\n        })\n      });\n    });\n\n    if (filterData.length == 0) {\n      return /*#__PURE__*/_jsx(\"div\", {\n        style: {\n          textAlign: \"center\",\n          marginTop: \"150px\",\n          color: \"#d0d0d0\"\n        },\n        children: \"No Item\"\n      });\n    } else {\n      return render;\n    }\n  };\n\n  var render = function render() {\n    if (loading) {\n      return /*#__PURE__*/_jsx(Spinner, {});\n    } else {\n      return /*#__PURE__*/_jsx(\"div\", {\n        className: styles.container,\n        children: /*#__PURE__*/_jsxs(\"div\", {\n          className: styles.wrapper,\n          children: [/*#__PURE__*/_jsx(Nav, {\n            title: \"Near Me\",\n            backAction: function backAction() {\n              return Router.push(\"/visit/unplan\");\n            },\n            color: \"white\"\n          }), /*#__PURE__*/_jsxs(\"div\", {\n            className: styles.main,\n            children: [/*#__PURE__*/_jsx(\"div\", {\n              className: styles.search_fixed,\n              children: /*#__PURE__*/_jsx(\"input\", {\n                onChange: function onChange(e) {\n                  setSearch(e.target.value);\n                },\n                placeholder: \"Search\",\n                className: styles.input,\n                style: {\n                  marginTop: \"0\"\n                }\n              })\n            }), /*#__PURE__*/_jsx(\"div\", {\n              style: {\n                margin: \"60px 0\"\n              },\n              children: renderList()\n            })]\n          })]\n        })\n      });\n    }\n  };\n\n  return render();\n}","map":null,"metadata":{},"sourceType":"module"}