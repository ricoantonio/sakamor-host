_N_E=(window.webpackJsonp_N_E=window.webpackJsonp_N_E||[]).push([[53],{"1LGx":function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/visit/unplan/nearme/[id]",function(){return n("1iwh")}])},"1iwh":function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return j}));var i=n("nKUr"),a=n("q1tI"),r=n("YFqc"),l=n.n(r),c=n("20a2"),s=n.n(c),o=n("Dfhs"),u=n.n(o),d=n("kQFM"),_=n("JkA1"),v=n("5PhN"),b=n("fj1f"),f=n("es2X"),p=n("ECGM"),h=n("UV+Q");function j(){var e=Object(a.useContext)(d.b),t=e.state,n=(e.dispatch,e.actions),r=Object(a.useState)(!0),o=r[0],j=r[1],m=Object(a.useState)(!1),x=m[0],y=m[1],O=Object(a.useState)(""),g=O[0],w=O[1],P=Object(a.useState)(!1),k=P[0],D=P[1],V=Object(a.useState)([]),C=V[0],I=V[1],N=Object(a.useState)({}),R=(N[0],N[1]),S=Object(a.useState)([]),U=S[0],A=S[1],M=Object(a.useState)(!1),q=M[0],B=M[1],L=Object(c.useRouter)(),J=new Date;Object(a.useEffect)((function(){L.query.id&&Object(p.H)().then((function(e){var t=e.filter((function(e){return e.outletID===L.query.id}));console.log(t),A(t),j(!1)})).catch((function(e){console.log(e)}))}),[L.query.id]);var E=function(e){D(!0),w(e),e?Object(p.D)(e).then((function(e){I(e)})).catch((function(e){console.log(e)})):I([])},T=function(e,a){var r=t.visitPlanReducer.visibility.filter((function(e){return null!==e.file&&null!==e.type&&null!==e.brand})),c=t.visitPlanReducer.avability;return Object(i.jsxs)("div",{children:[Object(i.jsxs)("div",{className:u.a.render_data,children:[e,Object(i.jsx)("div",{style:{textAlign:"right"},children:"Visibility"===e?"".concat(r.length,"/6"):"Avability"===e?"".concat(c.length,"/25"):""})]}),"Jenis Channel"===e?Object(i.jsxs)(i.Fragment,{children:[Object(i.jsx)("input",{onChange:function(e){E(e.target.value)},value:t.visitUnplanReducer.jenisChannel.namaJenisChannel?t.visitUnplanReducer.jenisChannel.namaJenisChannel:g,placeholder:"Search",className:u.a.input,onBlur:function(){setTimeout((function(){D(!1)}),200)},onFocus:function(e){return E(e.target.value)}}),k?Object(i.jsx)("div",{style:{position:"absolute",maxHeight:"180px",backgroundColor:"white",overflowY:"scroll",maxWidth:"400px",padding:"0 4px",zIndex:999999,marginTop:"-10px"},children:C.map((function(e,t){return Object(i.jsx)("div",{onClick:function(){R(e),n.setUnplanJenisChannel(e),w(e.namaJenisChannel),I([])},style:{borderBottom:".5px solid #f0f0f0",width:"350px"},children:e.namaJenisChannel},t)}))}):null]}):"Outlet"===e||"Alamat"===e?Object(i.jsx)(v.a,{style:{marginTop:"6px",borderRadius:"5px"},children:Object(i.jsx)("div",{className:u.a.render_value,children:a})}):"Catatan"===e?Object(i.jsx)(v.a,{style:{marginTop:"6px",borderRadius:"5px"},children:Object(i.jsx)("div",{className:u.a.render_value,children:Object(i.jsx)("textarea",{style:{width:"100%",border:"none",height:"70px"},onChange:function(e){n.setUnplanCatatan(e.target.value)},value:t.visitUnplanReducer.catatan})})}):"Visibility"===e||"Avability"===e?Object(i.jsx)(v.a,{style:{marginTop:"6px",borderRadius:"5px"},children:Object(i.jsxs)("div",{className:u.a.render_value,children:[Object(i.jsx)("div",{children:"Visibility"===e?Object(i.jsxs)("div",{children:[Object(i.jsx)("div",{className:u.a.progress_bar}),Object(i.jsx)("div",{className:u.a.progress_bar_now,style:{width:"".concat(r.length/6*100,"%")}})]}):"Avability"===e?Object(i.jsxs)("div",{children:[Object(i.jsx)("div",{className:u.a.progress_bar}),Object(i.jsx)("div",{className:u.a.progress_bar_now,style:{width:"".concat(c.length/25*100,"%")}})]}):""}),"Avability"===e?t.visitUnplanReducer.jenisChannel.namaJenisChannel?Object(i.jsx)(l.a,{href:"/visit/unplan/nearme/".concat(U[0].outletID,"/avability"),children:Object(i.jsx)("a",{children:Object(i.jsx)(f.a,{text:"Add"})})}):Object(i.jsx)(f.a,{text:"Add"}):"Visibility"===e?t.visitUnplanReducer.jenisChannel.namaJenisChannel?Object(i.jsx)(l.a,{href:"/visit/unplan/nearme/".concat(U[0].outletID,"/visibility"),children:Object(i.jsx)("a",{children:Object(i.jsx)(f.a,{text:"Add"})})}):Object(i.jsx)(f.a,{text:"Add"}):null]})}):Object(i.jsx)(v.a,{style:{marginTop:"6px",borderRadius:"5px"},children:Object(i.jsx)("div",{className:u.a.render_value,children:Object(i.jsx)(i.Fragment,{children:a})})})]})};return function(){var e=t.visitUnplanReducer.visibility.filter((function(e){return null!==e.file&&null!==e.type&&null!==e.brand}));return o?Object(i.jsx)(b.a,{}):Object(i.jsx)(i.Fragment,{children:Object(i.jsxs)("div",{className:u.a.container,children:[x?Object(i.jsx)(h.a,{children:Object(i.jsx)(b.a,{})}):null,Object(i.jsxs)("div",{className:u.a.wrapper,children:[Object(i.jsx)(_.a,{title:"Near Me",color:"white",action:"Submit",onClick:function(){!function(){if(t.visitPlanReducer.visibility.filter((function(e){return null!==e.file&&null!==e.type&&null!==e.brand})).length>=6){y(!0),B(!1);var e=JSON.parse(localStorage.getItem("user")),i={id:U.id,idMasterPlanVisit:U.id,nomorDokumen:U.nomorDokumen,catatan:t.visitPlanReducer.catatan,isCheckIn:!0,checkInDate:t.visitPlanReducer.checkIn.toISOString(),isCheckOut:!0,checkOutDate:J.toISOString(),createdBy:e.username,updatedBy:e.username},a=t.visitPlanReducer.visibility.map((function(e,t){return e.file})),r={avp:i,dProductList:t.visitPlanReducer.avability.map((function(t,n){return{id:U.id,activityVisitPlanId:U.id,nomorDokumen:U.nomorDokumen,nomor:n,kodeProduk:t.productFocus.produkID,namaProduk:t.productFocus.namaProduk,stok:parseInt(t.stock),saranOrder:parseInt(t.saranOrder),jumlahOrder:parseInt(t.order),createdBy:e.username,updatedBy:e.username,harga:parseInt(t.harga),total:parseInt(t.harga)*parseInt(t.order),keterangan:t.ket}}))};Object(p.M)(r).then((function(i){for(var r=t.visitPlanReducer.visibility.map((function(t,n){if(console.log(t),t.type&&t.file&&t.brand)return{id:U.id,activityVisitPlanId:i.avp.id,nomorDokumen:U.nomorDokumen,nomor:n,tipe:t.type.program,namaFile:t.file.name,createdBy:e.username,updatedBy:e.username,brandId:t.brand.id,namaBrand:t.brand.namaBrand}})),l=function(e){Object(p.N)(r[e],a[e]).then((function(t){5===e&&(y(!1),s.a.push("/"),n.setDefaultVisitPlan())})).catch((function(e){console.log(e)}))},c=0;c<a.length;c++)l(c)})).catch((function(e){console.log(e)}))}else B(!0)}()},disable:!(e.length>=6),backAction:function(){confirm("Data will be lost if you leave the page, are you sure?")&&(n.setDefaultVisitUnplan(),s.a.push("/visit/unplan/nearme"))}}),Object(i.jsxs)("div",{className:u.a.main,children:[q?Object(i.jsx)("div",{style:{color:"red",fontSize:"13px",textAlign:"center"},children:"Please complete visibility data"}):"",Object(i.jsxs)("div",{children:[T("Jenis Channel",t.visitUnplanReducer.jenisChannel.namaJenisChannel),T("Outlet",U[0].namaOutlet),T("Alamat",U[0].alamatOutlet),T("Catatan",t.visitUnplanReducer.catatan),T("Visibility"),T("Avability")]})]})]})]})})}()}},"4lBl":function(e,t,n){e.exports={modal:"Modal_modal__2IoMM"}},"5PhN":function(e,t,n){"use strict";var i=n("nKUr"),a=(n("q1tI"),n("M7ZG")),r=n.n(a);t.a=function(e){var t=e.children,n=e.style,a=e.shadow;return Object(i.jsx)("div",{className:"".concat(r.a.container," ").concat(a?r.a.shadow:""),style:n||{},children:t})}},Dfhs:function(e,t,n){e.exports={container:"VisitPlanDetail_container__2jr6z",wrapper:"VisitPlanDetail_wrapper__1k2PA",main:"VisitPlanDetail_main__2JVTk",render_data:"VisitPlanDetail_render_data__UG0Yf",avability_modal_subtitle:"VisitPlanDetail_avability_modal_subtitle__cImGw",render_value:"VisitPlanDetail_render_value__2U7Gk",input:"VisitPlanDetail_input__3EeAf",input_order_search:"VisitPlanDetail_input_order_search__3uxsM",input_order:"VisitPlanDetail_input_order__1WXcP",visibility_grid:"VisitPlanDetail_visibility_grid__eKqRB",grid_50:"VisitPlanDetail_grid_50__xScpT",visibility_grid_history:"VisitPlanDetail_visibility_grid_history__3RjRi",visibility_dropdown:"VisitPlanDetail_visibility_dropdown__1NliU",new_button:"VisitPlanDetail_new_button__3zBx9",input_file:"VisitPlanDetail_input_file__2mLHX",progress_bar:"VisitPlanDetail_progress_bar__Cz8_8",progress_bar_now:"VisitPlanDetail_progress_bar_now__3w_Ar",avability_bot_container:"VisitPlanDetail_avability_bot_container__1vyIh",avability_modal_container:"VisitPlanDetail_avability_modal_container__1BVd4",avability_modal_main:"VisitPlanDetail_avability_modal_main__isfSW",modal_avability:"VisitPlanDetail_modal_avability__3bVY8",hidden_overflow:"VisitPlanDetail_hidden_overflow__35jOV",add_title:"VisitPlanDetail_add_title__20KUY",stock_order_container:"VisitPlanDetail_stock_order_container__1-0Au",avg_sales_container:"VisitPlanDetail_avg_sales_container__2ZL8F",avabilitylist_title:"VisitPlanDetail_avabilitylist_title__3iIBI",avabilitylist_stock_container:"VisitPlanDetail_avabilitylist_stock_container__1iSbF",avabilitylist_container:"VisitPlanDetail_avabilitylist_container__WpqI9",avabilitylist_subtitle:"VisitPlanDetail_avabilitylist_subtitle__2LI2L",avabilitylist_value:"VisitPlanDetail_avabilitylist_value__21-Yx",search_fixed:"VisitPlanDetail_search_fixed__3uZmj",nav_box:"VisitPlanDetail_nav_box__2aVI9"}},GKTS:function(e,t,n){e.exports={container:"Button_container__37SWQ",container_white:"Button_container_white__zoABs"}},JkA1:function(e,t,n){"use strict";var i=n("nKUr"),a=(n("q1tI"),n("YFqc")),r=n.n(a),l=n("mPD6"),c=n.n(l);t.a=function(e){var t=e.backHref,n=e.title,a=e.action,l=e.color,s=e.onClick,o=e.backAction,u=e.noBack,d=e.disable;return Object(i.jsxs)("div",{className:"green"==l?"".concat(c.a.nav_green," ").concat(c.a.nav_container):"white"==l?"".concat(c.a.nav_white," ").concat(c.a.nav_container):c.a.nav_container,children:[t?Object(i.jsx)(r.a,{href:t||"/",children:Object(i.jsx)("a",{children:Object(i.jsx)("img",{style:{width:"24px"},src:"/arrow-left.svg"})})}):u?Object(i.jsx)("div",{}):Object(i.jsx)("img",{onClick:function(){o()},style:{width:"24px"},src:"/arrow-left.svg"}),Object(i.jsx)("div",{style:{textAlign:"center"},className:c.a.title,children:n}),a&&!1===d?Object(i.jsx)("div",{onClick:s,style:{fontSize:"14px",margin:"auto",color:"#41867A",cursor:"pointer"},children:a}):a&&!0===d?Object(i.jsx)("div",{onClick:s,style:{fontSize:"14px",margin:"auto",color:"#c4c4c4",cursor:"pointer"},children:a}):null]})}},M7ZG:function(e,t,n){e.exports={container:"Card_container__2ez1c",shadow:"Card_shadow__Tq5_x"}},"UV+Q":function(e,t,n){"use strict";var i=n("nKUr"),a=(n("q1tI"),n("YFqc"),n("4lBl")),r=n.n(a);n("20a2");t.a=function(e){var t=e.children,n=e.onClick;return Object(i.jsx)("div",{onClick:n,className:r.a.modal,children:t})}},YFqc:function(e,t,n){e.exports=n("cTJO")},cTJO:function(e,t,n){"use strict";var i=n("J4zp"),a=n("284h");t.__esModule=!0,t.default=void 0;var r=a(n("q1tI")),l=n("elyg"),c=n("nOHt"),s=n("vNVm"),o={};function u(e,t,n,i){if(e&&(0,l.isLocalURL)(t)){e.prefetch(t,n,i).catch((function(e){0}));var a=i&&"undefined"!==typeof i.locale?i.locale:e&&e.locale;o[t+"%"+n+(a?"%"+a:"")]=!0}}var d=function(e){var t=!1!==e.prefetch,n=(0,c.useRouter)(),a=n&&n.asPath||"/",d=r.default.useMemo((function(){var t=(0,l.resolveHref)(a,e.href,!0),n=i(t,2),r=n[0],c=n[1];return{href:r,as:e.as?(0,l.resolveHref)(a,e.as):c||r}}),[a,e.href,e.as]),_=d.href,v=d.as,b=e.children,f=e.replace,p=e.shallow,h=e.scroll,j=e.locale;"string"===typeof b&&(b=r.default.createElement("a",null,b));var m=r.Children.only(b),x=m&&"object"===typeof m&&m.ref,y=(0,s.useIntersection)({rootMargin:"200px"}),O=i(y,2),g=O[0],w=O[1],P=r.default.useCallback((function(e){g(e),x&&("function"===typeof x?x(e):"object"===typeof x&&(x.current=e))}),[x,g]);(0,r.useEffect)((function(){var e=w&&t&&(0,l.isLocalURL)(_),i="undefined"!==typeof j?j:n&&n.locale,a=o[_+"%"+v+(i?"%"+i:"")];e&&!a&&u(n,_,v,{locale:i})}),[v,_,w,j,t,n]);var k={ref:P,onClick:function(e){m.props&&"function"===typeof m.props.onClick&&m.props.onClick(e),e.defaultPrevented||function(e,t,n,i,a,r,c,s){("A"!==e.currentTarget.nodeName||!function(e){var t=e.currentTarget.target;return t&&"_self"!==t||e.metaKey||e.ctrlKey||e.shiftKey||e.altKey||e.nativeEvent&&2===e.nativeEvent.which}(e)&&(0,l.isLocalURL)(n))&&(e.preventDefault(),null==c&&(c=i.indexOf("#")<0),t[a?"replace":"push"](n,i,{shallow:r,locale:s,scroll:c}))}(e,n,_,v,f,p,h,j)},onMouseEnter:function(e){(0,l.isLocalURL)(_)&&(m.props&&"function"===typeof m.props.onMouseEnter&&m.props.onMouseEnter(e),u(n,_,v,{priority:!0}))}};if(e.passHref||"a"===m.type&&!("href"in m.props)){var D="undefined"!==typeof j?j:n&&n.locale,V=n&&n.isLocaleDomain&&(0,l.getDomainLocale)(v,D,n&&n.locales,n&&n.domainLocales);k.href=V||(0,l.addBasePath)((0,l.addLocale)(v,D,n&&n.defaultLocale))}return r.default.cloneElement(m,k)};t.default=d},dVq6:function(e,t,n){e.exports={container:"Spinner_container__3N6EY",spinner:"Spinner_spinner__3goiz","ball-spin-clockwise":"Spinner_ball-spin-clockwise__YJ_C3"}},es2X:function(e,t,n){"use strict";var i=n("nKUr"),a=(n("q1tI"),n("YFqc"),n("GKTS")),r=n.n(a);t.a=function(e){var t=e.onClick,n=e.text,a=e.submit,l=e.color;return Object(i.jsx)("button",{type:a?"submit":"",className:"white"===l?r.a.container_white:r.a.container,onClick:t,children:n})}},fj1f:function(e,t,n){"use strict";var i=n("nKUr"),a=n("dVq6"),r=n.n(a);t.a=function(){return Object(i.jsx)("div",{className:r.a.container,children:Object(i.jsxs)("div",{className:r.a.spinner,children:[Object(i.jsx)("div",{}),Object(i.jsx)("div",{}),Object(i.jsx)("div",{}),Object(i.jsx)("div",{}),Object(i.jsx)("div",{}),Object(i.jsx)("div",{}),Object(i.jsx)("div",{}),Object(i.jsx)("div",{})]})})}},mPD6:function(e,t,n){e.exports={nav_container:"Nav_nav_container__7SMgK",title:"Nav_title__21aLL",nav_green:"Nav_nav_green__1_B--",nav_white:"Nav_nav_white__1ml4-",white:"Nav_white__2liqq"}},vNVm:function(e,t,n){"use strict";var i=n("J4zp");t.__esModule=!0,t.useIntersection=function(e){var t=e.rootMargin,n=e.disabled||!l,s=(0,a.useRef)(),o=(0,a.useState)(!1),u=i(o,2),d=u[0],_=u[1],v=(0,a.useCallback)((function(e){s.current&&(s.current(),s.current=void 0),n||d||e&&e.tagName&&(s.current=function(e,t,n){var i=function(e){var t=e.rootMargin||"",n=c.get(t);if(n)return n;var i=new Map,a=new IntersectionObserver((function(e){e.forEach((function(e){var t=i.get(e.target),n=e.isIntersecting||e.intersectionRatio>0;t&&n&&t(n)}))}),e);return c.set(t,n={id:t,observer:a,elements:i}),n}(n),a=i.id,r=i.observer,l=i.elements;return l.set(e,t),r.observe(e),function(){l.delete(e),r.unobserve(e),0===l.size&&(r.disconnect(),c.delete(a))}}(e,(function(e){return e&&_(e)}),{rootMargin:t}))}),[n,t,d]);return(0,a.useEffect)((function(){if(!l&&!d){var e=(0,r.requestIdleCallback)((function(){return _(!0)}));return function(){return(0,r.cancelIdleCallback)(e)}}}),[d]),[v,d]};var a=n("q1tI"),r=n("0G5g"),l="undefined"!==typeof IntersectionObserver;var c=new Map}},[["1LGx",0,2,1,3,4]]]);